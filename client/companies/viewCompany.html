<template name="companyView">
    {{#if subscriptionReady}}
        <h1><a href="{{pathFor 'companies'}}">Company</a></h1>
        <h2>{{name}} {{>companyViewButtons}}</h2>
        {{#if parent_id}}
        <p><strong> &nbsp; Parent: </strong><a href="{{pathFor 'companyParent'}}">{{parent}}</a>
        </p>
        {{/if}}

        {{> companyViewDetails}}
        {{> companyRelatedLists}}
    {{/if}}
</template>

<template name="companyViewButtons">
    <div class="btn-group" style="margin: 10px 10px 10px;">
        <button type="button" class="btn btn-default edit_company"><span class="glyphicon glyphicon-pencil"></span></button>
        <button type="button" class="btn btn-default delete_company"><span class="glyphicon glyphicon-trash"></span></button>
    </div>
</template>

<template name="companyViewDetails">
    <div class="company">
        <p><strong>Industry: </strong>{{industry}}</p>
        <p><strong>Type: </strong>{{type}}</p>
        <p><strong>Phone: </strong>{{phone}}</p>
        <p><strong>Billing Street: </strong>{{billingstreet}}</p>
        <p><strong>Billing City: </strong>{{billingcity}}</p>
        <p><strong>Billing State: </strong>{{billingstate}}</p>
        <p><strong>Billing Zip: </strong>{{billingzip}}</p>
        <p><strong>Shipping Street: </strong>{{shippingstreet}}</p>
        <p><strong>Shipping City: </strong>{{shippingcity}}</p>
        <p><strong>Shipping State: </strong>{{shippingstate}}</p>
        <p><strong>Shipping Zip: </strong>{{shippingzip}}</p>
    </div>
</template>

<template name="companyRelatedLists">
    <div class="panel-group" id="accordion">
        {{> companyRelated_opportunities}}
        {{> companyRelated_projects}}
        {{> companyRelated_contacts}}
        {{> companyRelated_children}}
    </div>
</template>

<template name="companyRelated_opportunities">
    <div class="panel panel-default">
            <h3 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion" href="#opportunities">
              Opportunities
              </a>
            </h3>
            <div id="opportunities" class="panel-collapse collapse">
                <div class="panel-body">
                    {{#if childOpportunities.count}}
                    <div class="childOpportunities">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Owner</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                {{#each childOpportunities}} {{> childOpportunitiesListRow}} {{/each}}
                            </tbody>
                        </table>
                    </div>
                    {{else}}
                    <p><strong> There are no opportunities for this company. <a href="#">Create an Opportunity</a>.</strong>
                    </p>
                    {{/if}}
                    {{> childOpportunitiesListButtons}}
                </div>
            </div>
        </div>
</template>

<template name="childOpportunitiesListRow">
    <tr>
        <td> <a href="{{pathFor 'opportunityView'}}"> {{name}} </a> 
        </td>
        <td>{{owner_id}}</td>
        <td>{{> childOpportunitiesListRowOptions}}</td>
    </tr>
</template>

<template name="childOpportunitiesListRowOptions">
    <div class="btn-group">
        <button class="btn btn-default btn-xs dropdown-toggle" type="button" data-toggle="dropdown">
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
            <li><a href="#" class="edit_childOpportunity"><span class="glyphicon glyphicon-pencil"></span></a>
            </li>
            <li><a href="#" class="delete_childOpportunity"><span class="glyphicon glyphicon-trash"></span></a>
            </li>
        </ul>
    </div>
</template>

<template name="childOpportunitiesListButtons">
    <div class="btn-group">
        <button type="button" class="btn btn-default new_company_opportunity" data-toggle="modal" data-target="#"><span class="glyphicon glyphicon-plus"></span> New</button>
    </div>     
    
    <!--{{> newRateBookRoleModal}}
    {{> editRateBookRoleModal}}-->
</template>


<template name="companyRelated_projects">
    <div class="panel panel-default">
        <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#accordion" href="#projects">
                Projects
                </a>
            </h4>
        <div id="projects" class="panel-collapse collapse">
            <div class="panel-body">
                {{#if childProjects.count}}
                <div class="childProjects">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Owner</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each childProjects}} {{> childProjectsListRow}} {{/each}}
                        </tbody>
                    </table>
                </div>
                {{else}}
                <p><strong> There are no active projects for this company. <a href="#">Create a Project</a>.</strong>
                </p>
                {{/if}}
            </div>
        </div>
    </div>
</template>

<template name="childProjectsListRow">
    <tr>
        <td> <a href="{{pathFor 'projectView'}}"> {{name}} </a> 
        </td>
        <td>{{status}}</td>
    </tr>
</template>

<template name="companyRelated_contacts">
    <div class="panel panel-default">
        <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#accordion" href="#contacts">
                Contacts
                </a>
            </h4>
        <div id="contacts" class="panel-collapse collapse">
            <div class="panel-body">
                {{#if childContacts.count}}
                <div class="childContacts">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Owner</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each childContacts}} {{> childContactsListRow}} {{/each}}
                        </tbody>
                    </table>
                </div>
                {{else}}
                <p><strong> There are no contacts under this company. <a href="#">Create a Contact</a>.</strong>
                </p>
                {{/if}}
            </div>
        </div>
    </div>
</template>

<template name="childContactsListRow">
    <tr>
        <td> <a href="{{pathFor 'contactView'}}"> {{first_name}} </a> 
        </td>
        <td> <a href="{{pathFor 'contactView'}}"> {{last_name}} </a> 
        </td>
    </tr>
</template>

<template name="companyRelated_children">
    <div class="panel panel-default">
        <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#accordion" href="#children">Child Companies</a>
            </h4>
        <div id="children" class="panel-collapse collapse">
            <div class="panel-body">
                {{#if children.count}}
                <div class="children">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Owner</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each children}} {{> childCompanyListRow}} {{/each}}
                        </tbody>
                    </table>
                </div>
                {{else}}
                <p><strong> There are no child companies under this company. <a href="#">Create a Child Relationship</a>.</strong>
                </p>
                {{/if}}
            </div>
        </div>
    </div>
</template>

<template name="childCompanyListRow">
    <tr>
        <td> <a href="{{pathFor 'companyView'}}"> {{name}} </a> 
        </td>
        <td>{{owner_id}}</td>
    </tr>
</template>