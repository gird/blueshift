<template name="projectRelated_opportunities">
    <div class="panel panel-default">
        <h4 class="panel-title">
            <a data-toggle="collapse" href="#opportunities">Associated Opportunities</a>
        </h4>
        <div id="opportunities" class="panel-collapse collapse">
            <div class="panel-body">
                {{#if projectOpportunities.count}}
                <div class="relatedOpportunities">
                    <div class="table-responsive">
                        <table class="table tablesorter">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Estimated Amount</th>
                                    <th>Represented Amount</th>
                                    <th>Difference</th>
                                </tr>
                            </thead>
                            <tbody>
                                {{#each projectOpportunities}} {{> projectOpportunitiesListRow}} {{/each}}
                                <tr>
                                    <td></td>
                                    <td><strong>{{sum_estimated_amount}}</strong>
                                    </td>
                                    <td><strong>{{sum_represented_amount}}</strong>
                                    </td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                {{else}}
                <p><strong> Somethings wrong :\ There are no opportunities for this project and there should be.</strong>
                </p>
                {{/if}}
            </div>
        </div>
    </div>
</template>

<template name="projectOpportunitiesListRow">
    <tr>
        <td> <a href="{{pathFor 'opportunityView'}}"> {{name}} </a> 
        </td>
        <td>{{estimated_amount}}</td>
        <td>{{represented_amount}}</td>
        <td>{{unrepresented_amount}}</td>
    </tr>
</template>