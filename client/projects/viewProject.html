<template name="projectView">
    {{#if subscriptionReady}}
    <h1>
        <a href="{{pathFor 'projects'}}">
             <span class="glyphicon glyphicon-briefcase"></span>&nbsp;Project
        </a>
    </h1>
    <h2>
        {{name}} 
        {{>projectViewButtons}}
    </h2>
    <div class="col-md-6">
        {{> projectViewDetail}}
    </div>
    <div class="col-md-12">
        {{> projectRelatedLists}}
    </div>
    {{/if}}
</template>

<template name="projectViewButtons">
    <div class="btn-group" style="margin: 10px 10px 10px;">
        <button type="button" class="btn btn-default edit_project"><span class="glyphicon glyphicon-pencil"></span></button>
        <button type="button" class="btn btn-default delete_project"><span class="glyphicon glyphicon-trash"></span></button>
    </div>
</template>

<template name="projectViewDetail">
    <div class="project">
        <p><strong>Start Date: </strong>{{startDate}}</p>
        <p><strong>End Date: </strong>{{endDate}}</p>
        <p><strong>Situation: </strong>{{situation}}</p>
        <p><strong>Solution: </strong>{{solution}}</p>
        <p><strong>Probability: </strong>{{probability}}</p>
        <p><strong>Company: </strong><a href="{{pathFor 'projectCompany'}}">{{company}}</a></p>
        <p><strong>Rate Book: </strong><a href="{{pathFor 'projectRateBook'}}">{{rateBook}}</a></p>
    </div>
</template>

<!--Start of Lists related to the Project-->

<template name="projectRelatedLists">
    <div class="panel-group" id="accordion">
        {{> projectRelated_projectRoles}} 
        {{> projectRolesTimeline}}
        {{> projectRelated_opportunities}}        
    </div>
</template>

<template name="projectRelated_projectRoles">
    <div class="panel panel-default">
        <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#accordion" href="#projectRoles">
                    Project Roles
                </a>
            </h4>
        <div id="projectRoles" class="panel-collapse collapse in">
            <div class="panel-body">
                {{#if projectRoles.count}}
                <div class="childProjectRoles">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Status</th>
                                <th>Start Date</th>
                                <th>End Date</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each projectRoles}} 
                                {{> projectRolesListRow}} 
                            {{/each}}
                        </tbody>
                    </table>
                </div>
                {{else}}
                <p>There are currently no Project Roles for this Project.</p>
                {{/if}}
                {{> projectRolesButtons}}
            </div>
        </div>
    </div>
</template>

<template name="projectRolesListRow">
    <tr>
        <td> <a href="{{pathFor 'projectRoleView'}}"> {{role}} </a> 
        </td>
        <td>{{status}}</td>
        <td>{{startDate}}</td>
        <td>{{endDate}}</td>
        <td>{{> projectRolesListRowOptions}}</td>
    </tr>
</template>

<template name="projectRolesListRowOptions">
    <div class="btn-group">
        <button class="btn btn-default btn-xs dropdown-toggle" type="button" data-toggle="dropdown">
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
            <li><a href="#" class="edit_projectrole"><span class="glyphicon glyphicon-pencil"></span> </a>
            </li>
            <li><a href="#" class="delete_projectrole"><span class="glyphicon glyphicon-trash"></span></a>
            </li>
        </ul>
    </div>
</template>


<template name="projectRelated_opportunities">
    <div class="panel panel-default">
        <h4 class="panel-title">
            <a data-toggle="collapse" data-parent="#accordion" href="#opportunities">Associated Opportunities</a>
        </h4>
        <div id="opportunities" class="panel-collapse collapse">
            <div class="panel-body">
                {{#if projectOpportunities.count}}
                <div class="relatedOpportunities">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each projectOpportunities}} {{> projectOpportunitiesListRow}} {{/each}}
                        </tbody>
                    </table>
                </div>
                {{else}}
                <p><strong> Somethings wrong :\ There are no opportunities for this project and there should be.</strong>
                </p>
                {{/if}}
            </div>
        </div>
    </div>
</template>

<template name="projectOpportunitiesListRow">
    <tr>
        <td> <a href="{{pathFor 'opportunityView'}}"> {{name}} </a> 
        </td>
        <td>{{stage}}</td>
    </tr>
</template>
<!--End of Lists related to Project-->

<!--Start of Project Role modal-->
<template name="projectRolesButtons">
    <div class="btn-group">
        <button type="button" class="btn btn-default new-project-role" data-toggle="modal" data-target="#newProjectRoleModal"><span class="glyphicon glyphicon-plus"></span> Add</button>
    </div>
    {{> newProjectRoleModal}}
    <!--{{> editProjectRoleModal}}-->
</template>

<template name="newProjectRoleModal">
    <div class="modal fade" id="newProjectRoleModal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <form class="form-horizontal">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                        </button>
                        <h4 class="modal-title" id="myModalLabel">Add Role to {{name}}</h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label class="col-md-2 control-label">Role</label>
                            <div class="col-md-10">
                                <select class="form-control projectrole_ratebookroleid">
                                    <option value="" selected disabled>Select a Role...</option>
                                    {{#each roles}}
                                    <option value="{{this.rate_book_role_id}}">{{this.role_name}}</option>
                                    {{/each}}
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">Status</label>
                            <div class="col-md-10">
                                <select class="form-control projectrole_status">
                                    <option value="" selected disabled>Select a Status...</option>
                                    <option value="Assigned">Assigned</option>
                                    <option value="Claimed">Claimed</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">Start Date</label>
                            <div class="col-md-10">
                                <input type="date" class="form-control projectrole_startdate" placeholder="Select Date">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">End</label>
                            <div class="col-md-10">
                                <input type="date" class="form-control projectrole_enddate" placeholder="Select Date">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">Allocation</label>
                            <div class="col-md-10">
                                <div class="input-group">
                                    <span class="input-group-addon">%</span>
                                    <input type="decimal" class="form-control projectrole_allocation" placeholder="Enter Allocation">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">Probability</label>
                            <div class="col-md-10">
                                <div class="input-group">
                                    <span class="input-group-addon">%</span>
                                    <input type="decimal" class="form-control projectrole_probability" placeholder="Enter Probability">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <div class="btn-group">
                            <button type="button" class="btn btn-default cancel_new_projectrole" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span></button>
                        </div>
                        <div class="btn-group">
                            <button type="button" class="btn btn-primary submit_new_projectrole" disabled="{{submitIsDisabled}}"><span class="glyphicon glyphicon-floppy-disk"></span></button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</template>

<!--template name="editProjectRoleModal">
    <div class="modal fade" id="editProjectRoleModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <form class="form-horizontal">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                        </button>
                        <h4 class="modal-title" id="myModalLabel">Edit Role for {{this.name}}</h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label class="col-md-2 control-label">Rate</label>
                            <div class="col-md-10">
                                <div class="input-group">
                                    <span class="input-group-addon">$</span>
                                    <input type="text" class="form-control edit_ratebookrole_rate" placeholder="Enter Amount">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <div class="btn-group">
                            <button type="button" class="btn btn-default cancel_edit_ratebookrole" data-dismiss="modal">Close</button>
                        </div>
                        <div class="btn-group">
                            <button type="button" class="btn btn-primary submit_edit_ratebookrole" disabled="{{submitEditIsDisabled}}">Save changes</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</template-->
<!--End of Rate Book Roles related list templates-->